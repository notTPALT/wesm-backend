<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Quản Lý Nhà Trọ</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" />
  <link rel="stylesheet" href="../static/stylesheets/index.css" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  
</head>
<body class="bg-gray-100 font-sans text-gray-700">
  <div class="flex min-h-screen">
    <!-- Sidebar -->
    <aside class="bg-slate-800 text-slate-300 w-64 flex flex-col">
      <div class="px-5 py-4 border-b border-slate-700">
        <h1 class="text-white text-lg font-semibold tracking-wide">QUẢN LÝ NHÀ TRỌ</h1>
      </div>
      <nav class="flex-1 overflow-y-auto">
        <ul class="mt-3 space-y-1 text-sm">
          <li>
            <a href="#" class="sidebar-link flex items-center gap-3 px-5 py-2 hover:bg-slate-700 rounded active" data-page="home">
              <i class="fas fa-home w-4"></i>
              <span>Trang chủ</span>
            </a>
          </li>
          <li>
            <a href="#" class="sidebar-link flex items-center gap-3 px-5 py-2 hover:bg-slate-700 rounded" data-page="rooms">
              <i class="fas fa-bed w-4"></i>
              <span>Phòng</span>
            </a>
          </li>
        </ul>
      </nav>
    </aside>

    <!-- Main content -->
    <main class="flex-1 p-4 overflow-auto">
      <!-- Home Page -->
      <section id="home-page">
        <div class="bg-white rounded border border-gray-300 p-6 space-y-6">
          <h2 class="text-gray-600 font-semibold mb-4 text-xl">Tổng quan</h2>
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="bg-blue-100 rounded p-4 flex flex-col items-center">
              <span class="text-2xl font-bold text-blue-700" id="total-electric">0</span>
              <span class="text-gray-600 mt-2">Tổng số điện (kWh)</span>
            </div>
            <div class="bg-sky-100 rounded p-4 flex flex-col items-center">
              <span class="text-2xl font-bold text-sky-700" id="total-water">0</span>
              <span class="text-gray-600 mt-2">Tổng số nước (m³)</span>
            </div>
            <div class="bg-green-100 rounded p-4 flex flex-col items-center">
              <span class="text-2xl font-bold text-green-700" id="current-time">--:--:--</span>
              <span class="text-gray-600 mt-2">Thời gian hiện tại</span>
            </div>
          </div>
          <div class="mt-6">
            <h3 class="text-gray-600 font-semibold mb-2">Trạng thái Node</h3>
            <div class="flex gap-4">
              <div class="flex items-center gap-2">
                <span class="w-3 h-3 rounded-full bg-green-500 inline-block"></span>
                <span>Node 1: <span class="font-semibold text-green-700">Hoạt động</span></span>
              </div>
              <div class="flex items-center gap-2">
                <span class="w-3 h-3 rounded-full bg-green-500 inline-block"></span>
                <span>Node 2: <span class="font-semibold text-green-700">Hoạt động</span></span>
              </div>
              <div class="flex items-center gap-2">
                <span class="w-3 h-3 rounded-full bg-green-500 inline-block"></span>
                <span>Node 3: <span class="font-semibold text-green-700">Hoạt động</span></span>
              </div>
            </div>
          </div>
        </div>
      </section>
      <!-- Rooms Page -->
      <section id="rooms-page" class="hidden">
        <div class="bg-white rounded border border-gray-300 p-10">
          <h2 class="text-gray-600 font-semibold mb-6 text-2xl">Danh sách phòng</h2>
          <nav class="flex text-base font-semibold text-gray-600 border-b border-gray-300 mb-8 gap-4">
            <button class="floor-tab px-6 py-2 hover:bg-gray-100 active text-lg" type="button" data-floor="1">Tầng 1</button>
            <button class="floor-tab px-6 py-2 hover:bg-gray-100 text-lg" type="button" data-floor="2">Tầng 2</button>
            <button class="floor-tab px-6 py-2 hover:bg-gray-100 text-lg" type="button" data-floor="3">Tầng 3</button>
          </nav>
          <div id="rooms-container" class="flex flex-wrap gap-8 justify-center">
            <!-- Các box phòng sẽ được render ở đây bằng JS -->
          </div>
        </div>
      </section>
      <!-- Modal xem phòng -->
      <div id="room-modal" class="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg p-10 w-full max-w-4xl relative">
          <button id="close-modal" class="absolute top-2 right-2 text-gray-500 hover:text-red-500"><i class="fas fa-times"></i></button>
          <h3 class="text-lg font-semibold mb-4">Biểu đồ sử dụng <span id="modal-room-name"></span></h3>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
            <div>
              <canvas id="electric-chart"></canvas>
              <div class="text-center mt-2 text-sm text-gray-600">Điện 7 ngày</div>
            </div>
            <div>
              <canvas id="water-chart"></canvas>
              <div class="text-center mt-2 text-sm text-gray-600">Nước 7 ngày</div>
            </div>
          </div>
          <div class="mt-6 flex justify-end">
            <button id="export-bill" class="bg-blue-600 text-white px-4 py-2 rounded flex items-center gap-2"><i class="fas fa-file-invoice"></i> Xuất hóa đơn</button>
          </div>
        </div>
      </div>
      <!-- Modal hóa đơn -->
      <div id="bill-modal" class="fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-lg p-8 w-full max-w-lg relative">
          <button id="close-bill-modal" class="absolute top-2 right-2 text-gray-500 hover:text-red-500"><i class="fas fa-times"></i></button>
          <h3 class="text-xl font-semibold mb-6">Hóa đơn phòng <span id="bill-room-name"></span></h3>
          <table class="w-full text-lg mb-6 border">
            <thead>
              <tr class="border-b">
                <th class="py-2 text-left">Khoản</th>
                <th class="py-2 text-center">Chỉ số mới</th>
                <th class="py-2 text-center">Chỉ số cũ</th>
                <th class="py-2 text-center">Tiêu thụ</th>
                <th class="py-2 text-center">Đơn giá</th>
                <th class="py-2 text-right">Thành tiền</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td class="py-2">Giá nhà</td>
                <td class="py-2 text-center" colspan="4">-</td>
                <td class="py-2 text-right" id="bill-rent">3.000.000</td>
              </tr>
              <tr>
                <td class="py-2">Điện</td>
                <td class="py-2 text-center" id="bill-electric-moi"></td>
                <td class="py-2 text-center" id="bill-electric-cu"></td>
                <td class="py-2 text-center" id="bill-electric-consume"></td>
                <td class="py-2 text-center">3.500</td>
                <td class="py-2 text-right" id="bill-electric"></td>
              </tr>
              <tr>
                <td class="py-2">Nước</td>
                <td class="py-2 text-center" id="bill-water-moi"></td>
                <td class="py-2 text-center" id="bill-water-cu"></td>
                <td class="py-2 text-center" id="bill-water-consume"></td>
                <td class="py-2 text-center">15.000</td>
                <td class="py-2 text-right" id="bill-water"></td>
              </tr>
              <tr>
                <td class="py-2">Dịch vụ & vệ sinh</td>
                <td class="py-2 text-center" colspan="4">-</td>
                <td class="py-2 text-right">200.000</td>
              </tr>
              <tr class="font-bold border-t">
                <td class="py-2">Tổng</td>
                <td class="py-2 text-center" colspan="4"></td>
                <td class="py-2 text-right" id="bill-total"></td>
              </tr>
            </tbody>
          </table>
          <div class="flex justify-end gap-4">
            <button id="export-pdf" class="bg-green-600 text-white px-4 py-2 rounded flex items-center gap-2"><i class="fas fa-file-pdf"></i> Xuất PDF</button>
            <button id="close-bill-modal-2" class="bg-gray-400 text-white px-4 py-2 rounded">Đóng</button>
          </div>
        </div>
      </div>
    </main>
  </div>
  <script src="https://unpkg.com/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.2/jspdf.plugin.autotable.min.js"></script>
  <script src="../static/javascripts/index-script.js"></script>
</body>
</html>